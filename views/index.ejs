<!DOCTYPE html>
<html lang="<%= lang %>">
<head>
  <meta charset="UTF-8" />
  <title>Compare Filtered files vs San Diego PACE Rough Draft</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Pico.css (CDN, gratis) -->
  <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@2/css/pico.min.css" />
  <!-- Tus estilos de marca -->
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <main class="container">

  <!-- ðŸ”¹ Nuevo bloque de logo centrado -->
  <div class="logo-center">
    <img src="/CFS-Logo-Color.webp" alt="CFS Logo" class="logo-main" />
  </div>

  <header class="page-header">
    <div class="header-left">
      <h1 id="t_title">Compare Filtered files vs San Diego PACE Rough Draft</h1>
    </div>
    <div class="header-right">
      <label class="lang-select">
        <span id="t_language">Idioma</span>
        <select id="langSelect">
          <option value="es" <%= lang==='es'?'selected':'' %>>EspaÃ±ol</option>
          <option value="en" <%= lang==='en'?'selected':'' %>>English</option>
        </select>
      </label>
    </div>
  </header>

    <p id="t_hint" class="hint">
      Upload filters.csv, draft.csv and specialty.csv files
    </p>
  <!-- ðŸ”¹ Nueva secciÃ³n de instrucciones bilingÃ¼e -->
  <section class="card instructions-card">
    <h2 id="t_instructions_title">Instructions / Instrucciones</h2>
    <ol id="t_instructions_list">
      <li>Locate and Save your Rough Draft Excel sheet as a new CSV file, we suggest you to use an easy naming convention e.g. <strong>20251204_Draft.CSV</strong></li>
      <li>Locate and Save your R3 Excel sheet as a new CSV file, we suggest you to use an easy naming convention e.g. <strong>20251204_Filters.CSV</strong></li>
      <li>Locate the CSV specialty appointments file processed by the Manifest Parser.</li>
      <li>Once you have located all the 3 CSV files, proceed with the upload, after that, click on the "Process data" button.</li>
    </ol>

    <ol id="t_instructions_list_es" style="display:none;">
      <li>Localiza y Guarda tu hoja de Excel Rough Draft como un nuevo archivo CSV; te sugerimos usar una convenciÃ³n de nombre sencilla, por ejemplo <strong>20251204_Draft.CSV</strong></li>
      <li>Localiza y Guarda tu hoja R3 de Excel como un nuevo archivo CSV; te sugerimos usar una convenciÃ³n de nombre sencilla, por ejemplo <strong>20251204_Filters.CSV</strong></li>
      <li>Ubica el archivo CSV de citas de Specialty procesado por el Manifest Parser.</li>
      <li>Una vez localizados los 3 archivos CSV, procede a subirlos, despues de subirlos presiona el botÃ³n "Procesar datos".</li>
    </ol>
  </section>



    <!-- SecciÃ³n 1: Carga -->
    <section class="card">
      <h2 id="t_step1">1) Cargar archivos</h2>
      <form id="csvForm">
        <div class="grid">
          <label>
            <span>filters.csv</span>
            <input type="file" name="filters" id="fileFilters" accept=".csv" required />
            <small id="fileCountFilters" class="file-count">â€”</small>
          </label>
          <label>
            <span>draft.csv</span>
            <input type="file" name="draft" id="fileDraft" accept=".csv" required />
            <small id="fileCountDraft" class="file-count">â€”</small>
          </label>
          <label>
            <span>specialty.csv</span>
            <input type="file" name="specialty" id="fileSpecialty" accept=".csv" required />
            <small id="fileCountSpecialty" class="file-count">â€”</small>
          </label>
        </div>

        <button type="submit" id="t_process_btn" class="contrast">Procesar datos</button>
        <div id="status"></div>
      </form>
    </section>

    <!-- SecciÃ³n 2: Resultados -->
    <section class="card">
      <h2 id="t_step2">2) Resultados</h2>

      <article class="result-block">
        <header class="result-head">
          <h3 id="t_res1_title">trips_In_Filters_Not_In_Specialty.csv</h3>
          <a id="downloadCsv1" class="secondary" href="#" download="trips_In_Filters_Not_In_Specialty.csv" style="display:none;">
            â¬‡ <span id="t_download">Descargar CSV</span>
          </a>
        </header>
        <div id="table1" class="table-wrapper empty">Sin datos</div>
        <p id="count1" class="count-text">â€”</p>
      </article>

      <article class="result-block">
        <header class="result-head">
          <h3 id="t_res2_title">trips_In_Specialty_Not_In_Filters.csv</h3>
          <a id="downloadCsv2" class="secondary" href="#" download="trips_In_Specialty_Not_In_Filters.csv" style="display:none;">
            â¬‡ <span id="t_download2">Descargar CSV</span>
          </a>
        </header>
        <div id="table2" class="table-wrapper empty">Sin datos</div>
        <p id="count2" class="count-text">â€”</p>
      </article>
    </section>

    <!-- SecciÃ³n 3: BÃºsqueda -->
    <section class="card">
      <h2 id="t_step3">3) BÃºsqueda en Draft.csv</h2>
      <p class="hint" id="t_search_hint">
        Busca por <strong>PACE MRN</strong> o <strong>Patient</strong>.
      </p>

      <div class="grid search-grid">
        <input id="searchInput" type="text" placeholder="Criterio de bÃºsqueda (ej. Caro, SDP10035365)" />
        <button id="searchBtn" type="button">ðŸ”Ž <span id="t_search_btn">Buscar</span></button>
      </div>

      <div id="searchTable" class="table-wrapper empty">Sin datos</div>
    </section>

    <footer class="brand-footer">
      <small id="t_footer">CFS California Fleet Services Inc. 2025</small>
    </footer>
  </main>

  <script>
    window.__APP_LANG__ = "<%= lang %>";
  </script>
  <script src="/script.js"></script>
</body>
</html>
